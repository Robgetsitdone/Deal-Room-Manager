# Product Requirements Document: Deal Room Platform

**Version:** 2.0
**Author:** Rob
**Date:** February 12, 2026
**Build Target:** Replit (full-stack web app)

---

## 1. Product Overview

### What We're Building

A dead-simple deal room platform. Sales reps create branded, shareable content rooms for their prospects â€” upload files, drop in links, customize the look â€” and get full analytics on who opened it, what they clicked, how long they spent. Think Notion meets Dropbox meets buyer engagement tracking.

### The Problem

Reps email PDFs and slide decks as attachments. They have zero idea if the prospect opened them, which pages they read, or who on the buying committee even looked at it. Follow-up becomes guesswork. Meanwhile, prospects get a messy inbox full of loose files with no context.

### The Solution

A single shareable link per deal that gives the prospect a clean, branded page with all their content organized in one place. On the backend, the rep sees exactly who viewed what, when, and for how long.

### Core Feature Set

1. **Deal Room Builder** â€” Create a room, upload files, add descriptions, set the order, brand it
2. **Public Share Link** â€” One link per room, no login required for the prospect, optional email gate
3. **File Library** â€” Central database of all uploaded files across deal rooms, reusable
4. **Engagement Analytics** â€” Real-time tracking of views, clicks, time per asset, viewer identity
5. **Auth & Team Management** â€” Login, invite teammates, manage who can create/view rooms

### Target Users

| Persona | What They Do |
|---------|-------------|
| **Sales Rep (AE/SDR)** | Creates deal rooms, uploads content, shares links, checks analytics |
| **Sales Manager** | Views team-wide deal room activity, sees which deals are getting engagement |
| **Admin** | Manages users, org settings, file library |
| **Prospect (external)** | Opens the share link, views content â€” no login needed |

---

## 2. Tech Stack

```
Frontend:        Next.js 14 (App Router) + Tailwind CSS + shadcn/ui
Backend:         Next.js API Routes
Database:        PostgreSQL (Neon free tier or Replit DB add-on)
Auth:            Clerk (fastest setup on Replit) or NextAuth.js
File Storage:    Uploadthing (easiest on Replit) or Cloudflare R2
ORM:             Prisma
Analytics:       Custom event tracking (stored in PostgreSQL)
Deployment:      Replit Deployments
```

### Why These Choices

- **Clerk** over NextAuth: 5-minute setup, prebuilt components, handles invites/teams out of the box
- **Uploadthing** over raw S3: designed for Next.js, handles upload UI and storage in one package
- **PostgreSQL + Prisma**: type-safe, migrations work great on Replit, free tier on Neon handles this scale easily
- **No external analytics service**: we want granular, custom event data â€” easier to just store it ourselves

---

## 3. Data Models

```prisma
// â”€â”€â”€ AUTH & ORG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

model Organization {
  id          String     @id @default(cuid())
  name        String
  slug        String     @unique
  logoUrl     String?
  brandColor  String     @default("#2563EB")  // Default blue
  plan        Plan       @default(FREE)
  users       User[]
  dealRooms   DealRoom[]
  files       File[]
  createdAt   DateTime   @default(now())
}

model User {
  id             String       @id @default(cuid())
  clerkId        String       @unique          // Clerk external ID
  email          String       @unique
  name           String
  avatarUrl      String?
  role           UserRole     @default(MEMBER)
  organizationId String
  organization   Organization @relation(fields: [organizationId], references: [id])
  dealRooms      DealRoom[]   @relation("createdBy")
  createdAt      DateTime     @default(now())
}

enum UserRole {
  OWNER
  ADMIN
  MEMBER
}

enum Plan {
  FREE        // 5 deal rooms, 500MB storage
  PRO         // Unlimited rooms, 10GB, custom branding
  TEAM        // Everything + team analytics + SSO
}

// â”€â”€â”€ FILE LIBRARY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

model File {
  id             String          @id @default(cuid())
  fileName       String
  fileUrl        String
  fileType       String          // "pdf", "pptx", "docx", "png", "mp4", etc.
  fileSize       Int             // Bytes
  thumbnailUrl   String?         // Auto-generated preview image
  uploadedById   String
  organizationId String
  organization   Organization    @relation(fields: [organizationId], references: [id])
  dealRoomAssets DealRoomAsset[]  // A file can be in multiple deal rooms
  createdAt      DateTime        @default(now())
}

// â”€â”€â”€ DEAL ROOMS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

model DealRoom {
  id             String          @id @default(cuid())
  name           String          // Internal name (e.g., "Acme Corp â€” Q1 Proposal")
  headline       String?         // Public-facing headline shown to prospect
  welcomeMessage String?         // Optional intro text on the share page
  brandColor     String?         // Override org default
  logoUrl        String?         // Override org default
  backgroundUrl  String?         // Optional hero image
  status         DealRoomStatus  @default(DRAFT)
  shareToken     String          @unique @default(cuid())
  requireEmail   Boolean         @default(false)  // Gate access behind email capture
  password       String?         // Optional password protection
  allowDownload  Boolean         @default(true)
  expiresAt      DateTime?
  createdById    String
  createdBy      User            @relation("createdBy", fields: [createdById], references: [id])
  organizationId String
  organization   Organization    @relation(fields: [organizationId], references: [id])
  assets         DealRoomAsset[]
  views          DealRoomView[]
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
}

enum DealRoomStatus {
  DRAFT
  PUBLISHED
  EXPIRED
  ARCHIVED
}

model DealRoomAsset {
  id          String             @id @default(cuid())
  dealRoomId  String
  dealRoom    DealRoom           @relation(fields: [dealRoomId], references: [id], onDelete: Cascade)
  fileId      String
  file        File               @relation(fields: [fileId], references: [id])
  title       String             // Display title (can differ from file name)
  description String?            // Short description shown to prospect
  order       Int                // Sort order in the room
  section     String?            // Optional grouping label ("Proposal", "Case Studies", etc.)
  clicks      AssetClick[]
  createdAt   DateTime           @default(now())
}

// â”€â”€â”€ ANALYTICS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

model DealRoomView {
  id           String       @id @default(cuid())
  dealRoomId   String
  dealRoom     DealRoom     @relation(fields: [dealRoomId], references: [id], onDelete: Cascade)
  visitorId    String       @default(cuid())  // Anonymous ID (cookie-based)
  viewerEmail  String?      // Captured if requireEmail is on
  viewerName   String?
  viewerCompany String?
  ipAddress    String?
  city         String?      // Derived from IP (free geo-IP lookup)
  country      String?
  userAgent    String?
  device       String?      // "desktop", "mobile", "tablet" (parsed from UA)
  referrer     String?      // Where they came from
  duration     Int?         // Total seconds on the deal room page
  assetClicks  AssetClick[]
  viewedAt     DateTime     @default(now())
}

model AssetClick {
  id          String        @id @default(cuid())
  assetId     String
  asset       DealRoomAsset @relation(fields: [assetId], references: [id], onDelete: Cascade)
  viewId      String
  view        DealRoomView  @relation(fields: [viewId], references: [id], onDelete: Cascade)
  duration    Int?          // Seconds spent viewing this specific asset
  downloaded  Boolean       @default(false)  // Did they download it?
  clickedAt   DateTime      @default(now())
}
```

---

## 4. API Routes

### Auth (handled mostly by Clerk, plus custom sync)

```
POST   /api/auth/sync             Clerk webhook â†’ sync user to our DB
GET    /api/auth/me                Current user + org context
```

### Deal Rooms

```
GET    /api/deal-rooms                 List all rooms for current org
POST   /api/deal-rooms                 Create new room
GET    /api/deal-rooms/:id             Get room detail + assets + analytics summary
PUT    /api/deal-rooms/:id             Update room settings (name, branding, access controls)
DELETE /api/deal-rooms/:id             Archive room
PUT    /api/deal-rooms/:id/publish     Set status to PUBLISHED (generates share link)
PUT    /api/deal-rooms/:id/expire      Manually expire a room
POST   /api/deal-rooms/:id/duplicate   Clone a room (with same assets, fresh analytics)
```

### Assets (within a Deal Room)

```
POST   /api/deal-rooms/:id/assets              Add file(s) to room
PUT    /api/deal-rooms/:id/assets/:assetId      Update asset title, description, order, section
DELETE /api/deal-rooms/:id/assets/:assetId      Remove asset from room
PUT    /api/deal-rooms/:id/assets/reorder       Bulk reorder assets (accepts array of { id, order })
```

### File Library

```
GET    /api/files                   List all files in org (searchable, filterable by type)
POST   /api/files/upload            Upload new file (returns file record)
DELETE /api/files/:id               Delete file (fails if used in active deal rooms)
GET    /api/files/:id/usage         Which deal rooms use this file
```

### Public Share (no auth â€” prospect-facing)

```
GET    /api/share/:token            Get deal room public data (checks expiry, password, email gate)
POST   /api/share/:token/verify     Verify password or submit email to unlock
POST   /api/share/:token/track      Track a view event (page load)
POST   /api/share/:token/click      Track an asset click
POST   /api/share/:token/duration   Heartbeat â€” update time spent (sent every 30s via JS)
```

### Analytics

```
GET    /api/analytics/overview                  Org-wide: total rooms, views, clicks, top rooms
GET    /api/analytics/deal-rooms/:id            Per-room: viewer list, timeline, asset breakdown
GET    /api/analytics/deal-rooms/:id/viewers     Viewer detail: who, when, what they clicked, duration
GET    /api/analytics/deal-rooms/:id/assets      Per-asset engagement: clicks, avg duration, downloads
GET    /api/analytics/team                       Team leaderboard: rooms created, total engagement per rep
```

### Admin

```
GET    /api/admin/users              List org users
POST   /api/admin/users/invite       Send invite (via Clerk)
PUT    /api/admin/users/:id/role     Change role
DELETE /api/admin/users/:id          Remove from org
PUT    /api/admin/settings           Update org name, logo, default brand color
```

---

## 5. Pages & UI

### Internal App (requires login)

| Page | Route | What It Does |
|------|-------|-------------|
| **Dashboard** | `/` | Quick stats: rooms created, total views this week, most-viewed rooms, recent viewer activity feed |
| **Deal Rooms** | `/rooms` | Card grid of all rooms. Status badges (draft/live/expired). Search + filter. "New Room" button |
| **Room Builder** | `/rooms/new` | Step 1: Name + headline + welcome message. Step 2: Add files (upload or pick from library). Step 3: Arrange order + sections. Step 4: Branding (color, logo). Step 5: Access (email gate, password, expiry). Preview + Publish |
| **Room Detail** | `/rooms/:id` | Left: room settings + asset list (editable). Right: live analytics â€” viewer timeline, click heatmap, engagement score |
| **File Library** | `/files` | Grid/list of all uploaded files. Drag-and-drop upload. Filter by type. Shows which rooms each file is in |
| **Analytics** | `/analytics` | Org-wide engagement dashboard. Filter by date range, rep, room. Charts: views over time, top rooms, top assets, viewer companies |
| **Team** | `/team` | User list, roles, invite button |
| **Settings** | `/settings` | Org branding defaults, plan info |

### Public Deal Room (no login)

| Page | Route | What It Does |
|------|-------|-------------|
| **Email Gate** | `/r/:token` (if enabled) | Clean page asking for name + email + company before entering |
| **Deal Room** | `/r/:token` | Branded page: logo + headline at top, welcome message, asset cards in sections. Click asset â†’ opens viewer/download. Tracks everything |

### Deal Room Public Page Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Logo]                                  â”‚
â”‚                                          â”‚
â”‚  Welcome to your resource hub            â”‚
â”‚  Here's everything for our conversation  â”‚
â”‚                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  ğŸ“ PROPOSAL                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ ğŸ“„ PDF  â”‚ â”‚ ğŸ“Š PPTX â”‚                â”‚
â”‚  â”‚ Pricing â”‚ â”‚ Deck    â”‚                â”‚
â”‚  â”‚ Proposalâ”‚ â”‚ Overviewâ”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                          â”‚
â”‚  ğŸ“ CASE STUDIES                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“„ PDF  â”‚ â”‚ ğŸ“„ PDF  â”‚ â”‚ ğŸ¬ Videoâ”‚   â”‚
â”‚  â”‚ Acme Co â”‚ â”‚ Beta Incâ”‚ â”‚ Demo    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                          â”‚
â”‚                    Powered by DealRoom   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Analytics Deep Dive

### What We Track

**Per Deal Room:**

| Metric | How |
|--------|-----|
| Total views | Count of `DealRoomView` records |
| Unique visitors | Count of distinct `visitorId` values |
| Identified viewers | Views with an email captured |
| Avg time on page | Average `duration` across views |
| Asset click-through rate | Clicks / views |
| Most-clicked asset | Asset with highest click count |
| Download count | Sum of `AssetClick` where `downloaded = true` |

**Per Viewer (identified by email or visitorId):**

| Metric | How |
|--------|-----|
| Visit count | Number of `DealRoomView` records for this visitor |
| Total time spent | Sum of `duration` across visits |
| Assets viewed | List of `AssetClick` records with timestamps |
| Last active | Most recent `viewedAt` |
| Device / location | Parsed from `userAgent` + IP geo-lookup |

**Per Asset:**

| Metric | How |
|--------|-----|
| Click count | Count of `AssetClick` records |
| Unique viewers who clicked | Distinct `viewId` â†’ `visitorId` |
| Avg view duration | Average `duration` on `AssetClick` |
| Download count | `downloaded = true` count |

### Real-Time Tracking Implementation

The public deal room page includes a lightweight JS tracker:

```javascript
// On page load â†’ POST /api/share/:token/track
// Returns a viewId

// On asset click â†’ POST /api/share/:token/click
// Sends { assetId, viewId }

// Every 30 seconds â†’ POST /api/share/:token/duration
// Sends { viewId, totalSeconds }
// (Uses visibilitychange API to pause when tab is hidden)

// On asset download â†’ POST /api/share/:token/click
// Sends { assetId, viewId, downloaded: true }
```

### Analytics Dashboard Wireframe

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEAL ROOM ANALYTICS            [Date Range â–¾]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  47  â”‚  â”‚  31  â”‚  â”‚ 2:34 â”‚  â”‚  83% â”‚        â”‚
â”‚  â”‚Views â”‚  â”‚Uniqueâ”‚  â”‚ Avg  â”‚  â”‚Click â”‚        â”‚
â”‚  â”‚      â”‚  â”‚Visit.â”‚  â”‚ Time â”‚  â”‚Rate  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                  â”‚
â”‚  VIEWS OVER TIME                                 â”‚
â”‚  â–â–‚â–ƒâ–…â–‡â–ˆâ–‡â–…â–ƒâ–‚â–â–‚â–ƒâ–…â–‡  (line chart, daily)          â”‚
â”‚                                                  â”‚
â”‚  RECENT VIEWERS                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ sarah@acme.com    â”‚ 3 visits â”‚ 4:12 totalâ”‚   â”‚
â”‚  â”‚ mike@acme.com     â”‚ 1 visit  â”‚ 1:30 totalâ”‚   â”‚
â”‚  â”‚ Anonymous (NYC)   â”‚ 2 visits â”‚ 2:45 totalâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  ASSET ENGAGEMENT                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Pricing Proposal.pdf   â”‚ 38 clicks â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ â”‚
â”‚  â”‚ Product Overview.pptx  â”‚ 29 clicks â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ â”‚
â”‚  â”‚ Acme Case Study.pdf    â”‚ 14 clicks â”‚ â–ˆâ–ˆâ–ˆ   â”‚ â”‚
â”‚  â”‚ Demo Recording.mp4     â”‚ 8 clicks  â”‚ â–ˆâ–ˆ    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. Phased Build Plan

### Phase 1: Auth + File Library (3-4 days)

**Goal:** Users can sign up, create an org, and upload files

- [ ] Next.js 14 + Tailwind + shadcn/ui scaffold
- [ ] Clerk integration (sign up, sign in, org creation)
- [ ] Prisma schema + PostgreSQL setup (Neon)
- [ ] Clerk webhook to sync users to DB
- [ ] File upload endpoint (Uploadthing or S3)
- [ ] File Library page: upload, list, delete, filter by type
- [ ] Thumbnail generation for PDFs and images

### Phase 2: Deal Room CRUD (4-5 days)

**Goal:** Reps can create and manage deal rooms

- [ ] Deal Room creation flow (name, headline, welcome message)
- [ ] Add files from library to a room
- [ ] Drag-and-drop reorder assets
- [ ] Section grouping for assets
- [ ] Branding customization (color picker, logo upload)
- [ ] Access controls (email gate toggle, password, expiry date)
- [ ] Deal Room list page with status badges and search
- [ ] Publish / unpublish / archive actions
- [ ] Duplicate room functionality

### Phase 3: Public Share Page (3-4 days)

**Goal:** Prospects can view deal rooms via a share link

- [ ] Public route `/r/:token` â€” renders deal room with branding
- [ ] Email gate page (if enabled) â€” captures name, email, company
- [ ] Password protection check
- [ ] Expiry check (show "this room has expired" if past date)
- [ ] Asset cards with file type icons and descriptions
- [ ] Section grouping in the UI
- [ ] Click to open asset (PDF viewer / image viewer / video player / download)
- [ ] Responsive design (works on mobile)
- [ ] "Powered by [Product Name]" footer

### Phase 4: Analytics Tracking (3-4 days)

**Goal:** Every interaction on the public page is tracked

- [ ] Tracking script on public page: page view, clicks, duration heartbeat, downloads
- [ ] `DealRoomView` created on page load (captures IP, UA, referrer, geo)
- [ ] `AssetClick` created on each asset open
- [ ] Duration tracking with 30-second heartbeats (pauses when tab hidden)
- [ ] Visitor identity resolution: anonymous cookie â†’ identified once email submitted
- [ ] Device/browser parsing from user agent
- [ ] City/country from free IP geolocation API (ip-api.com or similar)

### Phase 5: Analytics Dashboard (4-5 days)

**Goal:** Reps and managers can see engagement data

- [ ] Room Detail analytics panel: summary stats, viewer list, asset breakdown
- [ ] Viewer detail view: visit history, assets clicked, time per asset
- [ ] Views over time chart (recharts)
- [ ] Asset engagement bar chart
- [ ] Org-wide analytics page: top rooms, total engagement, team leaderboard
- [ ] Date range filter
- [ ] Real-time activity feed on dashboard ("sarah@acme.com just viewed Pricing Proposal")
- [ ] Email notification when a deal room gets its first view (optional)

### Phase 6: Polish (3-4 days)

**Goal:** Production-ready

- [ ] Invite teammates flow (Clerk invitations + role sync)
- [ ] Settings page (org branding defaults, plan info)
- [ ] Empty states for all pages
- [ ] Loading skeletons
- [ ] Error handling and toast notifications
- [ ] SEO + Open Graph tags on public deal room pages (for nice link previews)
- [ ] Rate limiting on public tracking endpoints
- [ ] Mobile responsiveness pass
- [ ] Seed data script for demo

**Total estimated build time: ~3-4 weeks**

---

## 8. Project Structure (Replit)

```
/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ (auth)/
â”‚   â”‚   â”œâ”€â”€ sign-in/page.tsx
â”‚   â”‚   â””â”€â”€ sign-up/page.tsx
â”‚   â”œâ”€â”€ (dashboard)/
â”‚   â”‚   â”œâ”€â”€ layout.tsx              # Sidebar nav + Clerk provider
â”‚   â”‚   â”œâ”€â”€ page.tsx                # Dashboard home
â”‚   â”‚   â”œâ”€â”€ rooms/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx            # Deal room list
â”‚   â”‚   â”‚   â”œâ”€â”€ new/page.tsx        # Room builder
â”‚   â”‚   â”‚   â””â”€â”€ [id]/page.tsx       # Room detail + analytics
â”‚   â”‚   â”œâ”€â”€ files/page.tsx          # File library
â”‚   â”‚   â”œâ”€â”€ analytics/page.tsx      # Org-wide analytics
â”‚   â”‚   â”œâ”€â”€ team/page.tsx           # Team management
â”‚   â”‚   â””â”€â”€ settings/page.tsx       # Org settings
â”‚   â”œâ”€â”€ r/
â”‚   â”‚   â””â”€â”€ [token]/page.tsx        # Public deal room page
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ auth/sync/route.ts      # Clerk webhook
â”‚       â”œâ”€â”€ deal-rooms/
â”‚       â”‚   â”œâ”€â”€ route.ts            # GET list, POST create
â”‚       â”‚   â””â”€â”€ [id]/
â”‚       â”‚       â”œâ”€â”€ route.ts        # GET, PUT, DELETE
â”‚       â”‚       â”œâ”€â”€ publish/route.ts
â”‚       â”‚       â”œâ”€â”€ duplicate/route.ts
â”‚       â”‚       â””â”€â”€ assets/
â”‚       â”‚           â”œâ”€â”€ route.ts    # POST add, PUT reorder
â”‚       â”‚           â””â”€â”€ [assetId]/route.ts
â”‚       â”œâ”€â”€ files/
â”‚       â”‚   â”œâ”€â”€ route.ts            # GET list, POST upload
â”‚       â”‚   â””â”€â”€ [id]/route.ts       # DELETE, GET usage
â”‚       â”œâ”€â”€ share/
â”‚       â”‚   â””â”€â”€ [token]/
â”‚       â”‚       â”œâ”€â”€ route.ts        # GET public data
â”‚       â”‚       â”œâ”€â”€ verify/route.ts # POST email/password
â”‚       â”‚       â”œâ”€â”€ track/route.ts  # POST view event
â”‚       â”‚       â”œâ”€â”€ click/route.ts  # POST asset click
â”‚       â”‚       â””â”€â”€ duration/route.ts # POST heartbeat
â”‚       â”œâ”€â”€ analytics/
â”‚       â”‚   â”œâ”€â”€ overview/route.ts
â”‚       â”‚   â””â”€â”€ deal-rooms/
â”‚       â”‚       â””â”€â”€ [id]/
â”‚       â”‚           â”œâ”€â”€ route.ts
â”‚       â”‚           â”œâ”€â”€ viewers/route.ts
â”‚       â”‚           â””â”€â”€ assets/route.ts
â”‚       â””â”€â”€ admin/
â”‚           â”œâ”€â”€ users/route.ts
â”‚           â””â”€â”€ settings/route.ts
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/                         # shadcn/ui components
â”‚   â”œâ”€â”€ deal-room/
â”‚   â”‚   â”œâ”€â”€ room-card.tsx
â”‚   â”‚   â”œâ”€â”€ room-builder.tsx
â”‚   â”‚   â”œâ”€â”€ asset-list.tsx
â”‚   â”‚   â”œâ”€â”€ branding-editor.tsx
â”‚   â”‚   â””â”€â”€ access-controls.tsx
â”‚   â”œâ”€â”€ analytics/
â”‚   â”‚   â”œâ”€â”€ stats-cards.tsx
â”‚   â”‚   â”œâ”€â”€ views-chart.tsx
â”‚   â”‚   â”œâ”€â”€ viewer-table.tsx
â”‚   â”‚   â””â”€â”€ asset-engagement.tsx
â”‚   â”œâ”€â”€ files/
â”‚   â”‚   â”œâ”€â”€ file-grid.tsx
â”‚   â”‚   â”œâ”€â”€ upload-zone.tsx
â”‚   â”‚   â””â”€â”€ file-picker-modal.tsx
â”‚   â””â”€â”€ public/
â”‚       â”œâ”€â”€ deal-room-page.tsx
â”‚       â”œâ”€â”€ email-gate.tsx
â”‚       â””â”€â”€ asset-card.tsx
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ db.ts                       # Prisma client
â”‚   â”œâ”€â”€ auth.ts                     # Clerk helpers
â”‚   â”œâ”€â”€ upload.ts                   # File upload helpers
â”‚   â”œâ”€â”€ geo.ts                      # IP geolocation
â”‚   â”œâ”€â”€ tracking.ts                 # Client-side tracking script
â”‚   â””â”€â”€ utils.ts
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma
â”œâ”€â”€ public/
â”‚   â””â”€â”€ placeholder-logo.svg
â”œâ”€â”€ .env
â”œâ”€â”€ .replit
â”œâ”€â”€ package.json
â””â”€â”€ tailwind.config.ts
```

---

## 9. Getting Started on Replit

```bash
# 1. Create Next.js project
npx create-next-app@latest . --typescript --tailwind --app --src-dir=false

# 2. Install core deps
npm install prisma @prisma/client
npm install @clerk/nextjs
npm install uploadthing @uploadthing/react
npm install recharts
npm install ua-parser-js

# 3. Install shadcn/ui
npx shadcn-ui@latest init
npx shadcn-ui@latest add button card input label dialog dropdown-menu \
  table tabs badge separator avatar sheet toast skeleton

# 4. Set up Prisma
npx prisma init
# â†’ paste schema from this PRD into prisma/schema.prisma
# â†’ set DATABASE_URL in .env (Neon connection string)
npx prisma migrate dev --name init
npx prisma generate

# 5. Set up Clerk
# â†’ Create app at clerk.com, grab keys
# â†’ Add NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY and CLERK_SECRET_KEY to .env

# 6. Set up Uploadthing
# â†’ Create app at uploadthing.com, grab keys
# â†’ Add UPLOADTHING_SECRET and UPLOADTHING_APP_ID to .env

# 7. Run it
npm run dev
```

### Environment Variables

```env
DATABASE_URL="postgresql://..."
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY="pk_..."
CLERK_SECRET_KEY="sk_..."
UPLOADTHING_SECRET="sk_..."
UPLOADTHING_APP_ID="..."
NEXT_PUBLIC_APP_URL="https://your-repl.replit.app"
```

---

## 10. Key Decisions & Trade-offs

| Decision | Why |
|----------|-----|
| **No Chrome extension** | Keeps scope tight. Deal rooms are standalone web pages |
| **Clerk over NextAuth** | Team/org management built in. Less code to write |
| **Cookie-based visitor ID** | Tracks repeat visitors without requiring login. Upgrades to identified when they submit email |
| **PostgreSQL for analytics** | At this scale (thousands of events, not millions), a separate analytics DB is overkill. Postgres handles it fine with proper indexes |
| **Uploadthing over raw S3** | One less thing to configure. Handles upload UI components too |
| **No AI features in V1** | Keep it simple. AI summarization of deal room engagement can come in V2 |
| **Sections not folders** | Assets are flat with optional section labels, not nested folders. Simpler data model, simpler UI |

---

*This PRD can be pasted directly into Replit's AI agent. It has everything needed to build: data models, API routes, project structure, and a phased plan scoped to ~3-4 weeks for a solo builder.*
